<!DOCTYPE html>
<html>
<head>
    <title>Test Regex Pattern</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Test Regex Pattern for OrderInfo Parsing</h1>
    
    <div>
        <h3>Test Case 1: Normal case</h3>
        <p>OrderInfo: "Thanh toán hóa đơn 1 - User 110"</p>
        <button onclick="testRegex('Thanh toán hóa đơn 1 - User 110')">Test</button>
        <div id="result1"></div>
    </div>
    
    <div>
        <h3>Test Case 2: With year (problematic case)</h3>
        <p>OrderInfo: "Thanh toán hóa đơn 2024-11 - User 110"</p>
        <button onclick="testRegex('Thanh toán hóa đơn 2024-11 - User 110')">Test</button>
        <div id="result2"></div>
    </div>
    
    <div>
        <h3>Test Case 3: Encoded case</h3>
        <p>OrderInfo: "Thanh toĂ¡n hĂ³a Ä'Æ¡n 2024-11 - User 110"</p>
        <button onclick="testRegex('Thanh toĂ¡n hĂ³a Ä'Æ¡n 2024-11 - User 110')">Test</button>
        <div id="result3"></div>
    </div>
    
    <div>
        <h3>Test Case 4: Custom input</h3>
        <input type="text" id="customOrderInfo" placeholder="Enter orderInfo here" style="width: 400px;">
        <button onclick="testCustomRegex()">Test Custom</button>
        <div id="result4"></div>
    </div>

    <script>
        function testRegex(orderInfo) {
            console.log('Testing orderInfo:', orderInfo);
            
            let invoiceId = null;
            let userId = null;
            
            // Pattern 1: Normal case with negative lookahead
            let pattern1 = /hóa đơn\s*(\d+)(?!-\d{2})/;
            let match1 = orderInfo.match(pattern1);
            if (match1) {
                invoiceId = match1[1];
                console.log('Pattern 1 matched - invoiceId:', invoiceId);
            }
            
            // Pattern 2: Encoded case
            if (!invoiceId) {
                let pattern2 = /Ä'Æ¡n\s*(\d+)(?!-\d{2})/;
                let match2 = orderInfo.match(pattern2);
                if (match2) {
                    invoiceId = match2[1];
                    console.log('Pattern 2 matched - invoiceId:', invoiceId);
                }
            }
            
            // Pattern 3: Extract from beginning
            if (!invoiceId) {
                let pattern3 = /^.*?(\d+)(?!-\d{2}).*User/;
                let match3 = orderInfo.match(pattern3);
                if (match3) {
                    invoiceId = match3[1];
                    console.log('Pattern 3 matched - invoiceId:', invoiceId);
                }
            }
            
            // Parse userId
            let userPattern = /User\s*(\d+)/;
            let userMatch = orderInfo.match(userPattern);
            if (userMatch) {
                userId = userMatch[1];
                console.log('User pattern matched - userId:', userId);
            }
            
            let result = `
                <strong>OrderInfo:</strong> ${orderInfo}<br>
                <strong>Parsed invoiceId:</strong> ${invoiceId || 'NOT FOUND'}<br>
                <strong>Parsed userId:</strong> ${userId || 'NOT FOUND'}<br>
                <strong>Success:</strong> ${invoiceId && userId ? 'YES' : 'NO'}
            `;
            
            // Determine which result div to update
            if (orderInfo.includes('2024-11') && orderInfo.includes('Ä')) {
                document.getElementById('result3').innerHTML = result;
            } else if (orderInfo.includes('2024-11')) {
                document.getElementById('result2').innerHTML = result;
            } else {
                document.getElementById('result1').innerHTML = result;
            }
        }
        
        function testCustomRegex() {
            let orderInfo = document.getElementById('customOrderInfo').value;
            if (orderInfo) {
                testRegex(orderInfo);
                document.getElementById('result4').innerHTML = `
                    <strong>OrderInfo:</strong> ${orderInfo}<br>
                    <strong>Check console for detailed results</strong>
                `;
            }
        }
    </script>
</body>
</html> 